# 基于 C++ 与权威网络架构的脱颖而出级 UE5 FPS Demo 实施蓝图

**「题目说明」**

基于ue5官方的First Person模板，实现一个游戏demo。具体要求如下：

1. demo需实现会移动和攻击玩家的敌人功能，玩家可以击败敌人；
2. demo需实现基础的得分和游戏胜利机制，具体玩法可以自由发挥；
3. demo中需实现多人网络对战；

提示：如有余力，可自行学习游戏开发其他内容继续添加功能，如渲染、游戏AI等。

**「提交格式」**

文件名称：姓名-学校-开局一课客户端大作业

文件格式：PDF（请在文档中简要说明你的技术实现过程，并附上GitHub链接）

**「提交时间」**

2026年1月31日北京时间23:59前



本报告旨在为期一个半月（2025年月日至2026年1月31日）的 Unreal Engine 5 (UE5) FPS Demo 项目提供一套高级工程实施方案与工作流程。目标是将此结课作业打造为一份符合腾讯面试官“T字型”发展模式要求的精英级项目，重点突出程序开发的**垂直深度**（C++、权威网络架构）和**水平广度**（高级AI、渲染技术理解）。作为一名专注于 UE C++ 架构、多人网络同步和复杂 AI 系统的资深游戏工程师，本方案将指导项目在有限时间内实现技术复杂性和工程稳健性的最大化。

## 1. 项目战略定位与“T字型”发展策略

为确保项目能在众多申请者中脱颖而出，其定位必须超越基础复刻，专注于高难度的系统工程实现。面试官通常会评估候选人在某个领域的专业深度，同时兼顾对游戏开发整体流程的理解。

### 1.1 垂直深度核心：C++与权威网络架构

项目成功的**必要条件**在于核心系统的稳定与高级架构的应用。对于游戏程序员而言，最能体现工程能力和专业深度的领域是 C++ 驱动的 Gameplay 编程和网络同步 1。

该项目的垂直深度应聚焦于以下方面：

1. **UE C++ 核心编程：** 避免仅使用蓝图实现核心 Gameplay 逻辑。大部分功能，特别是武器系统、伤害计算和 AI 决策，必须通过 C++ 实现，并在蓝图中暴露必要接口，这符合行业对高级程序员的期望 1。
2. **权威网络同步：** 实现多人网络对战功能时，必须采用**权威服务器模型** 。这意味着所有关键的游戏状态和逻辑（如伤害判定、得分变动、敌人行为）都必须在服务器上执行，客户端仅进行预测和视觉渲染。这是保障游戏公平性和防止作弊的基础。

### 1.2 水平广度扩展：AI与技术美术的结合

在核心深度稳定后，项目需要展示对引擎全栈功能和跨领域知识的理解，以完善“T”字的横向部分 2。

水平广度应体现在：

1. **高级 AI 决策：** 采用 C++ 驱动的 **行为树 (Behavior Tree, BT)** 配合 **环境查询系统 (Environment Query System, EQS)** 5，使敌人的行为具备战术性，而非简单的追逐。
2. **渲染与性能理解：** 策略性地应用 UE5 的现代渲染特性，如 Lumen 和 Nanite ，并实现自定义的 **Post Process Material (着色器)** ，展示对渲染管线和性能优化的认知。

## 2. 精细化工作流规划：1.5个月时间轴

时间管理是决定项目交付质量的关键。由于时间限制（约 7 周），项目必须采用**核心功能先行 (Core Loop First)** 的迭代方法，确保最复杂且风险最高的网络架构部分在前三周内完成并稳定。

### 2.1 核心任务划分与时间分配

以下时间表将 C++ 核心编程和网络架构视为高优先级 (P0)，必须在时间表中占据主要权重。

Table Title: 核心任务划分与时间分配（2025年月日 - 2026年1月31日）

| **周数 (大致日期)** | **阶段名称**            | **核心 C++ 任务 (垂直深度)**                                 | **水平广度/打磨任务**                           | **权重 (%)** |
| ------------------- | ----------------------- | ------------------------------------------------------------ | ----------------------------------------------- | ------------ |
| 周 1                | 框架搭建与基础 MVP      | 搭建 C++ 项目结构。定义核心 Actor (GameMode/State/PlayerState)。实现基础 C++ 玩家移动/输入 (非复制) 。 | 基础关卡设计/资源导入。HUD/得分UI基础蓝图实现。 | 20%          |
| 周 2                | 网络架构与核心同步 (P0) | 权威服务器模型下角色运动同步 (扩展CMC) 。武器系统 C++ 实现 (RepNotify/RPC) 。伤害、生命值、击杀得分的复制 。 | 基础胜利/失败状态处理。联机测试。               | 40%          |
| 周 4                | 高级 AI 架构 (P1)       | C++驱动的 AIController, Blackboard, Behavior Tree实现。实现 AI 感知 (AIPerception)。 | AI 巡逻路径 (Spline) 设置。基础 AI 动画集成。   | 15%          |
| 周 5                | 深度 AI 与系统打磨      | C++集成 EQS (找掩体/攻击位置) 6。尝试实现高级网络优化：Server Rewind 击中检测 。 | 完善计分板、回合结束逻辑。                      | 15%          |
| 周 6                | 视觉打磨与性能优化      | 渲染设置：Lumen/Nanite 策略性应用 。体积雾与动态灯光优化 。自定义 Post Process 材质 (Shader知识展示)。 | 游戏反馈 (声音、相机震动、Decals) 。性能分析。  | 5%           |
| 周 7                | 最终文档与演示          | 录制专业级 Demo 视频 (突出技术亮点)。撰写详细的技术案例研究文档。简历更新。 |                                                 | 5%           |



### 2.2 风险管理与模块化设计

项目管理的战略考量决定了功能的实现顺序。鉴于 FPS 游戏对网络延迟和同步的严格要求 ，如果基础的权威运动和伤害复制在前三周未能稳定，后续的 AI 和视觉工作将毫无价值。因此，必须将高级的广度功能（如 Server Rewind 或复杂的自定义渲染）视为**模块化、可插拔**的特性。这意味着即使在时间压力下未能完全实现这些高级功能，核心的 C++ 网络深度也已锁定，保证了项目简历的含金量。这种工程风险管理优先级分配是专业开发人员必备的能力。

## 3. 垂直深度：C++ 权威多人网络架构实施细节

项目能否获得高评价，主要取决于其在处理网络延迟、同步和防作弊方面的工程质量。这是对 C++ 程序员能力最直接的验证。

### 3.1 权威服务器模型与核心类职责

在 UE 中，权威性原则要求所有 Gameplay 状态和逻辑在服务器端执行。

为了实现稳健的联机架构，必须在 C++ 中明确定义和扩展核心网络类，并严格遵守其在复制中的职责：

1. **AGameModeBase (C++)：** 仅在服务器上运行，负责定义游戏规则、控制阶段流转和进行伤害验证。
2. **AGameStateBase (C++)：** 负责复制**全局游戏状态**，例如当前得分榜 (`Scoreboard`) 或比赛时间 (`MatchTime`)。这些数据应通过 **RepNotify** 机制同步。
3. **APlayerState (C++)：** 负责复制**单个玩家的持久状态**，如玩家分数 (`PlayerScore`)、名字和最重要的：**生命值 (Health)** 和**死亡状态 (Mortality)**。`APlayerState` 的状态复制保证了新加入的玩家也能立即获取正确信息。
4. **ACharacter (C++)：** 负责运动同步和瞬时动作的视觉表现。角色的状态如武器弹药 (`WeaponAmmo`) 也应使用 RepNotify 同步。

### 3.2 数据复制的 C++ 实践：RepNotify 与 RPC

在 C++ 中，`RepNotify` 和 `RPC` (Remote Procedure Calls) 的选择体现了对网络带宽和状态持久性的理解。

- **RepNotify 的选择：** 必须使用 `UPROPERTY(ReplicatedUsing=OnRep_Variable)` 实现状态变量的同步。RepNotify 适用于需要持久同步且状态变化的变量，例如角色的生命值、死亡状态、开关门状态等。当变量值改变时，服务器将向所有相关的客户端发送更新，并触发本地的 `OnRep_` 函数（例如，生命值变化后触发 UI 更新或播放受击动画）。这种机制保证了状态的最终一致性。
- **RPC 的选择：** RPC 仅用于瞬时、一次性或不可靠的动作，例如客户端向服务器发送一个“我想开火”的请求，或服务器通知所有客户端播放一个仅用于视觉效果的粒子系统 。RPC 不会重发给后来加入的客户端，因此不应用于关键状态同步。

### 3.3 FPS 核心：C++ 运动同步与客户端预测

实现低延迟 FPS 体验的最高级挑战在于角色移动的同步。默认的 UE 运动组件难以满足高精度联机 FPS 的需求。

解决这一问题的工程方法是：**继承和扩展 `UCharacterMovementComponent` (CMC)** 。在 C++ 中实现自定义的 Saved Moves 和 Client Prediction（客户端预测）逻辑 。客户端在本地预测其移动以消除输入延迟，并定期将输入历史发送给服务器。服务器随后执行权威性的运动模拟，并发送校正状态 (Reconciliation) 给客户端。成功实施这一机制，特别是通过 C++ 实现 `FCharacterMove` 等自定义数据结构来处理输入历史，是向面试官展示高级 C++ 网络编程深度的决定性亮点 。

### 3.4 联机 FPS 击中检测：延迟补偿 (Server Rewind)

为了在网络延迟环境下保证击中判定的公平性和准确性，应采用**延迟补偿 (Lag Compensation)** 技术，例如 **Server Rewind (服务器回溯)** 。

- **技术原理：** 当客户端发送开火请求时，它会附带一个本地时间戳。服务器接收到请求后，不会简单地在当前时间进行射线检测，而是将所有潜在被击中角色的位置状态“回溯”到客户端开火时的那个时间点（即时间戳所示的时间） 。
- **工程价值：** 这一技术极大地提高了联机 FPS 的用户体验和公平性。即使在时间限制下无法完全实现 Server Rewind，项目文档中详细描述其**架构设计**和原理（例如，使用快照插值/Snapshot Interpolation 的概念 ），足以证明对高性能网络游戏核心机制的深刻理解。

## 4. 水平广度：高级游戏 AI 系统架构

AI 系统是展示程序广度知识的第二大领域。目标是创造具备战术决策能力的敌人，并展示对 UE AI 框架的 C++ 驱动控制。

### 4.1 架构选择：C++ Behavior Tree 与 EQS 集成

避开使用简单的蓝图 `AI Move To` 节点 。项目必须将核心 AI 逻辑架构在 C++ 驱动的 **行为树 (Behavior Tree)** 上 5。

1. **C++ AI Controller：** 创建自定义的 `AMyAIController`。它负责启动行为树，管理 `Blackboard` 资产，并集成 AI 感知系统 (`AIPerceptionComponent`) 5。
2. **C++ 行为节点：** 将通用的 AI 逻辑（如状态设置、距离检测、复杂寻路任务）封装为 C++ 实现的 **Behavior Tree Tasks, Services, 和 Decorators** 5。例如，定义一个 C++ Task 用于处理复杂的战斗逻辑切换，这比纯蓝图实现更高效且更具工程价值。

### 4.2 环境查询系统 (EQS) 的 C++ 集成

EQS 是实现智能、动态决策的关键工具 6。它允许 AI 查询环境，为决策过程提供数据，例如，找到最佳的掩体或伏击位置 6。

- **C++ 实施要点：**
    1. 在 `AMyAIController` 中声明对 `UEnvQuery` 资产的引用 。
    2. 通过 C++ 代码，使用 `FEnvQueryRequest` 结构体来包装和执行查询，并指定查询的运行模式（例如 `EEnvQueryRunMode::SingleResult`） 。
    3. 关键在于处理查询结果。通过定义 C++ 委托方法 (`FQueryFinishedSignature`)，在 EQS 异步返回结果后，AI Controller 可以根据结果调用 `MoveToLocation`，指示 AI 角色移动到查询到的最佳位置（如掩体） 。

EQS 的使用将 AI 复杂度提升了一个等级，因为它允许 AI 根据多维度权重测试（如距离、视线阻挡、资源点接近度）来动态选择战术，而非遵循预设的静态路径。

### 4.3 行为树设计：状态与优先级

利用 Blackboard Asset 管理 AI 的状态（如 `TargetActor`, `BehaviorState`） 5。行为树的设计应包含关键的战术状态，如巡逻 (`Patrolling`)、搜索 (`Searching`) 和战斗 (`Engaging`)。通过精确设置行为树节点的优先级和中止条件，可以确保 AI 在被玩家感知到时，能立即中止低优先级任务（如巡逻），切换到高优先级任务（如攻击或寻找掩护），从而实现智能的反应行为 。

## 5. 水平广度：视觉打磨与技术美术呈现

专业的视觉效果是让 Demo “眼前一亮”的广度展示。重点在于展示对 UE5 渲染流程的理解，而非仅仅使用资产。

### 5.1 UE5 核心渲染技术策略与优化

- **Lumen 与 Nanite 的策略性应用：** 确认对 UE5 核心技术（Lumen 全局光照和 Nanite 虚拟几何体）的了解，并通过在场景中策略性地应用高细节模型和高质量光照来展示其效果 。
- **动态光照优化：** 虽然动态照明提供了极佳的视觉效果，但它也是性能瓶颈之一 。在进行光照设置时，应注意优化光源的移动性 (Mobility)，将不必要的动态光源设置为静态 (Static) 或静止 (Stationary)，以控制性能开销 。
- **体积雾 (Volumetric Fog) 增强：** 利用指数高度雾 (Exponential Height Fog) 配合定向光，调整散射密度 (`Volumetric Scattering`) 和衰减度 (`Extinction Scale`) 。这项工作可以快速营造出电影级的环境氛围，是一种高效的视觉提升。

### 5.2 自定义 Post Process Material (Custom Shaders)

自定义 Post Process Material 是展示对渲染管线底层理解的关键。着色器 (Shader) 编程是程序开发人员跨越技术美术领域的有力证明 。

- **实现路径：** 创建一个 Material Asset，并将其 `Material Domain` 设置为 `Post Process` 。然后通过 Post Process Volume 或摄像机将其应用到场景中 25。
- **推荐功能：** 实现一个能够利用 `Scene Texture` 节点的自定义效果 。例如，一个**“受伤反馈着色器”**：当玩家生命值低时，通过后处理材质获取屏幕颜色信息，并叠加扭曲、颜色去饱和或红边效果。这不仅提供了强大的视觉反馈，也展示了对渲染缓冲区和着色器编程的理解。

### 5.3 游戏反馈与打磨

在开发末期，必须注重游戏反馈的细节，这是决定游戏 Demo 质量的关键。包括集成高质量的音效、精确的相机震动 (`Camera Shake`)、以及基于物理的击中贴花 (`Decals`) 。这些元素共同构成了一个专业且沉浸式的 FPS 体验。

## 6. 脱颖而出的文档与展示策略

项目完成后的展示和文档撰写与技术实现本身同等重要。项目必须被包装成一个专业的**技术案例研究 (Technical Case Study)**，突出解决的技术难点和个人贡献 。

### 6.1 项目案例研究结构

文档应聚焦于个人在复杂系统实现中的角色，展示迭代过程和技术决策的理由。

1. **垂直深度展示：权威网络架构：**
    - **技术挑战：** 详细描述在实现低延迟 FPS 联机时遇到的网络漂移、状态不一致和作弊防御挑战。
    - **C++ 架构详解：** 提供架构图，说明如何通过扩展 `UCharacterMovementComponent` 实现客户端预测/服务器调解的流程 。
    - **核心亮点：** 详细解释 Server Rewind/Snapshot Interpolation 的原理，即使未完全实现，也要说明其设计意图和与网络延迟处理的关系 。展示使用 RepNotify 而非 Multicast RPC 来同步核心状态（如生命值和得分）的 C++ 代码片段，以证明网络最佳实践的应用 。
2. **水平广度展示：高级 AI 与决策：**
    - **分层架构：** 描述 C++ AIController、Behavior Tree 和 Blackboard 的结构，说明职责分离。
    - **EQS 智能：** 详细说明如何通过 C++ 驱动的 EQS 查询让 AI 动态找到最佳掩体或攻击角度 6。
    - **迭代与调试：** 记录在调试 AI 感知和行为树优先级时遇到的问题以及解决方案，展示设计迭代能力 。
3. **技术美术与性能：**
    - 展示自定义 Post Process Material 的材质节点图或相关 C++ Shader 代码，说明如何利用 `Scene Texture` 节点实现视觉效果，证明对渲染管线的理解 。
    - 讨论在应用 Lumen、Nanite 和体积雾时所做的性能优化措施 。

### 6.2 演示视频与简历策略

- **演示视频：** 录制专业级高分辨率视频，重点展示多人联机下的流畅移动、AI 复杂行为（如 AI 找掩体和侧翼移动）、以及高级视觉效果。
- **简历关键词：** 确保简历清晰、准确地使用高价值的工程关键词，这对于通过 ATS 筛选和吸引面试官的注意力至关重要 2。关键词应包括：`Unreal Engine C++`、`Server-Authoritative Networking`、`Client-Side Prediction & Reconciliation`、`UCharacterMovementComponent Extension`、`Behavior Tree / EQS (C++ Driven)`、`RepNotify / RPC Best Practices`、以及 `Post Process Material / Shader Implementation`。

## . 结论与建议

要在一个半月内完成一个“脱颖而出”的 UE5 FPS Demo，关键在于聚焦于程序开发中最能体现工程价值的领域：**权威网络架构**和**C++ 驱动的系统**。

**核心建议：**

1. **锁定 C++ 网络：** 务必在项目的前 40% 时间内（前三周）完成 C++ 驱动的权威运动同步和 RepNotify 状态复制。网络的稳定性和权威性是此项目垂直深度的基石。
2. **模块化实现高级功能：** 将 Server Rewind 和 EQS 集成视为提升项目上限的模块。即使不能完全实现，在文档中详尽描述其设计原理和架构意图，已足以证明对高级工程问题的深刻理解。
3. **专业化展示：** 将最终项目包装为技术案例研究，详细阐述 C++ 代码决策和架构图，突出个人在解决复杂技术挑战中的贡献，从而完全符合腾讯面试官对 T 字型人才的要求。